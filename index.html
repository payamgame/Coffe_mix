<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Ú©Ø§ÙÛŒ Ù…ÛŒÚ©Ø³ | ØªØ±Ú©ÛŒØ¨â€ŒØ³Ø§Ø² Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ù‚Ù‡ÙˆÙ‡</title>
    <link href="https://cdn.fontcdn.ir/Font/Persian/Yekan/Yekan.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-dark: #2C1810;
            --primary: #6F4E37;
            --primary-light: #A67B5B;
            --secondary: #C4A484;
            --accent: #E6B17E;
            --cream: #FDF6E9;
            --white: #FFFFFF;
            --text-dark: #2C1810;
            --text-light: #6F4E37;
            --shadow: 0 10px 30px rgba(44, 24, 16, 0.1);
            --shadow-strong: 0 15px 40px rgba(44, 24, 16, 0.2);
            --gradient: linear-gradient(135deg, #6F4E37, #A67B5B);
            --gradient-light: linear-gradient(135deg, #C4A484, #E6B17E);
        }

        body {
            font-family: 'Yekan', sans-serif;
            background: var(--cream);
            color: var(--text-dark);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Ù‡Ø¯Ø± Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† */
        .header {
            background: linear-gradient(165deg, var(--primary-dark) 0%, var(--primary) 100%);
            color: white;
            padding: 2rem 1rem 3rem 1rem;
            border-radius: 0 0 40px 40px;
            box-shadow: var(--shadow-strong);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "â˜•";
            position: absolute;
            top: -20px;
            left: -20px;
            font-size: 150px;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        .header::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-light);
        }

        .header-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .header-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            animation: slideDown 0.6s ease;
        }

        .header-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            max-width: 300px;
            margin: 0 auto;
            animation: slideUp 0.6s ease 0.2s both;
        }

        @keyframes slideDown {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .container {
            padding: 0 1rem;
            margin-top: -1.5rem;
            position: relative;
            z-index: 10;
        }

        /* Ú©Ø§Ø±Øª Ø§ØµÙ„ÛŒ */
        .card {
            background: var(--white);
            border-radius: 30px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            border: 1px solid rgba(166, 123, 91, 0.2);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 2px dashed var(--secondary);
        }

        .card-header h2 {
            font-size: 1.4rem;
            color: var(--primary-dark);
            flex: 1;
        }

        .card-header-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        /* Ø§Ø³Ù„Ø§ÛŒØ¯Ø±Ù‡Ø§ */
        .slider-group {
            margin-bottom: 2rem;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .slider-label span:first-child {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: bold;
            color: var(--primary-dark);
        }

        .slider-value {
            background: var(--gradient);
            color: white;
            padding: 0.2rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, var(--accent), var(--primary));
            border-radius: 10px;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            border: 3px solid var(--primary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            background: var(--primary-light);
        }

        .slider-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 0.3rem;
            font-size: 0.8rem;
            color: var(--text-light);
        }

        /* Ø±ÙˆØ´ Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ */
        .method-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
            margin: 1rem 0;
        }

        .method-btn {
            background: var(--cream);
            border: 2px solid var(--secondary);
            border-radius: 15px;
            padding: 1rem 0.5rem;
            font-family: 'Yekan', sans-serif;
            font-size: 0.95rem;
            color: var(--primary-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
        }

        .method-btn span:first-child {
            font-size: 1.5rem;
        }

        .method-btn.active {
            background: var(--gradient);
            color: white;
            border-color: var(--primary-dark);
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(111, 78, 55, 0.3);
        }

        /* Ø¯Ú©Ù…Ù‡ Ø§ØµÙ„ÛŒ */
        .generate-btn {
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 1.2rem;
            width: 100%;
            font-family: 'Yekan', sans-serif;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(111, 78, 55, 0.3);
            margin-top: 1rem;
        }

        .generate-btn:active {
            transform: scale(0.98);
        }

        .generate-btn[disabled] {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .loading-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: var(--accent);
            width: 0%;
            transition: width 3s linear;
        }

        /* Ù¾Ù†Ù„ Ù†ØªÛŒØ¬Ù‡ */
        .result-panel {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            margin-top: 1rem;
        }

        .result-panel.show {
            opacity: 1;
            transform: translateY(0);
        }

        .roast-badge {
            background: var(--gradient-light);
            padding: 0.5rem 1rem;
            border-radius: 30px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .roast-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary-dark);
        }

        .roast-dot.light { background: #D4A76A; }
        .roast-dot.medium-light { background: #B08C5D; }
        .roast-dot.medium { background: #9C6E3D; }
        .roast-dot.medium-dark { background: #6D4C2B; }
        .roast-dot.dark { background: #2C1810; }

        /* ØªØ±Ú©ÛŒØ¨ Ù‚Ù‡ÙˆÙ‡ */
        .blend-list {
            background: var(--cream);
            border-radius: 20px;
            padding: 1rem;
            margin: 1.5rem 0;
        }

        .blend-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px dashed var(--secondary);
        }

        .blend-item:last-child {
            border-bottom: none;
        }

        .blend-name {
            font-weight: bold;
            color: var(--primary-dark);
        }

        .blend-percent {
            background: var(--gradient);
            color: white;
            padding: 0.2rem 1rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* Ù†Ù…ÙˆØ¯Ø§Ø± Ø·Ø¹Ù… */
        .flavor-chart {
            width: 100%;
            aspect-ratio: 1;
            background: var(--cream);
            border-radius: 30px;
            padding: 1rem;
            margin: 1.5rem 0;
            position: relative;
        }

        .flavor-svg {
            width: 100%;
            height: 100%;
        }

        .flavor-labels {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .flavor-label {
            position: absolute;
            font-size: 0.8rem;
            color: var(--primary-dark);
            font-weight: bold;
            background: rgba(255,255,255,0.9);
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
        }

        /* Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ */
        .instructions {
            background: var(--gradient-light);
            border-radius: 20px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            color: var(--primary-dark);
        }

        .instructions h3 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .instructions-list {
            list-style: none;
        }

        .instructions-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instructions-list li:last-child {
            border-bottom: none;
        }

        .instructions-list li::before {
            content: "â€¢";
            color: var(--primary-dark);
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ */
        .welcome-popup {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(44, 24, 16, 0.95);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            padding: 1rem;
        }

        .welcome-popup.show {
            opacity: 1;
            pointer-events: auto;
        }

        .popup-content {
            background: white;
            border-radius: 30px;
            padding: 2rem;
            max-width: 400px;
            width: 100%;
            text-align: center;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { transform: scale(0.8) translateY(20px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .popup-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .popup-title {
            font-size: 1.8rem;
            color: var(--primary-dark);
            margin-bottom: 1rem;
        }

        .popup-text {
            color: var(--text-light);
            margin-bottom: 2rem;
            line-height: 1.8;
        }

        .popup-btn {
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 1rem 2rem;
            width: 100%;
            font-family: 'Yekan', sans-serif;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .popup-btn:active {
            transform: scale(0.95);
        }

        /* Ø¯Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ù‡ÙˆÙ‡ ØªØ²Ø¦ÛŒÙ†ÛŒ */
        .coffee-bean {
            position: fixed;
            opacity: 0.1;
            font-size: 3rem;
            pointer-events: none;
            z-index: -1;
            animation: float 6s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        .bean-1 { top: 10%; right: 5%; animation-delay: 0s; }
        .bean-2 { bottom: 10%; left: 5%; animation-delay: 2s; }
        .bean-3 { top: 30%; left: 10%; animation-delay: 4s; }

        .footer {
            text-align: center;
            padding: 2rem 0;
            color: var(--text-light);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="coffee-bean bean-1">ğŸŒ°</div>
    <div class="coffee-bean bean-2">ğŸŒ°</div>
    <div class="coffee-bean bean-3">ğŸŒ°</div>

    <div class="welcome-popup" id="welcomePopup">
        <div class="popup-content">
            <div class="popup-icon">â˜•</div>
            <h2 class="popup-title">Ø¨Ù‡ Ú©Ø§ÙÛŒâ€ŒÙ…ÛŒÚ©Ø³ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!</h2>
            <p class="popup-text">
                Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¯Ø§Ù†Ø´ ØªØ®ØµØµÛŒ Ù‚Ù‡ÙˆÙ‡ØŒ ØªØ±Ú©ÛŒØ¨ Ø´Ø®ØµÛŒ Ø®ÙˆØ¯Øª Ø±Ùˆ Ø¨Ø³Ø§Ø².<br>
                ÙÙ‚Ø· Ú©Ø§ÙÛŒÙ‡ Ø³Ù„ÛŒÙ‚Ù‡â€ŒØ§Øª Ø±Ùˆ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØŒ Ø¨Ù‚ÛŒÙ‡â€ŒØ´ Ø¨Ø§ Ù…Ø§!
            </p>
            <button class="popup-btn" onclick="closePopup()">Ù…ÛŒâ€ŒØ®ÙˆØ§Ù… Ø´Ø±ÙˆØ¹ Ú©Ù†Ù…</button>
        </div>
    </div>

    <div class="header">
        <div class="header-content">
            <h1 class="header-title">Ú©Ø§ÙÛŒâ€ŒÙ…ÛŒÚ©Ø³</h1>
            <p class="header-subtitle">ØªØ±Ú©ÛŒØ¨â€ŒØ³Ø§Ø² Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ù‚Ù‡ÙˆÙ‡ Ø¨Ù‡ Ø³Ù„ÛŒÙ‚Ù‡ Ø´Ù…Ø§</p>
        </div>
    </div>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <div class="card-header-icon">âš¡</div>
                <h2>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø·Ø¹Ù…</h2>
            </div>

            <div class="slider-group">
                <div class="slider-label">
                    <span>ØªÙ„Ø®ÛŒ <span style="font-size: 1.2rem;">ğŸ˜‹</span></span>
                    <span class="slider-value" id="bitternessVal">50%</span>
                </div>
                <input type="range" min="0" max="100" value="50" id="bitterness">
                <div class="slider-footer">
                    <span>Ù…Ù„Ø§ÛŒÙ…</span>
                    <span>Ø´Ø¯ÛŒØ¯</span>
                </div>
            </div>

            <div class="slider-group">
                <div class="slider-label">
                    <span>Ø§Ø³ÛŒØ¯ÛŒØªÛŒ <span style="font-size: 1.2rem;">ğŸ‹</span></span>
                    <span class="slider-value" id="acidityVal">50%</span>
                </div>
                <input type="range" min="0" max="100" value="50" id="acidity">
                <div class="slider-footer">
                    <span>Ù…Ù„Ø§ÛŒÙ…</span>
                    <span>Ø²Ù†Ø¯Ù‡</span>
                </div>
            </div>

            <div class="slider-group">
                <div class="slider-label">
                    <span>Ø´ÛŒØ±ÛŒÙ†ÛŒ <span style="font-size: 1.2rem;">ğŸ¯</span></span>
                    <span class="slider-value" id="sweetnessVal">50%</span>
                </div>
                <input type="range" min="0" max="100" value="50" id="sweetness">
                <div class="slider-footer">
                    <span>Ú©Ù…</span>
                    <span>Ø²ÛŒØ§Ø¯</span>
                </div>
            </div>

            <div class="slider-group">
                <div class="slider-label">
                    <span>Ø¨Ø§Ø¯ÛŒ <span style="font-size: 1.2rem;">ğŸ’ª</span></span>
                    <span class="slider-value" id="bodyVal">50%</span>
                </div>
                <input type="range" min="0" max="100" value="50" id="body">
                <div class="slider-footer">
                    <span>Ø³Ø¨Ú©</span>
                    <span>Ø³Ù†Ú¯ÛŒÙ†</span>
                </div>
            </div>

            <div class="slider-group">
                <div class="slider-label">
                    <span>Ù…ÛŒÙˆÙ‡â€ŒØ§ÛŒ <span style="font-size: 1.2rem;">ğŸ“</span></span>
                    <span class="slider-value" id="fruitinessVal">50%</span>
                </div>
                <input type="range" min="0" max="100" value="50" id="fruitiness">
                <div class="slider-footer">
                    <span>Ú©Ù…</span>
                    <span>Ø²ÛŒØ§Ø¯</span>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-header-icon">â˜•</div>
                <h2>Ø±ÙˆØ´ Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ</h2>
            </div>

            <div class="method-grid">
                <button class="method-btn active" data-method="espresso">
                    <span>ğŸ”¥</span>
                    <span>Ø§Ø³Ù¾Ø±Ø³Ùˆ</span>
                </button>
                <button class="method-btn" data-method="pourOver">
                    <span>ğŸ’§</span>
                    <span>V60</span>
                </button>
                <button class="method-btn" data-method="frenchPress">
                    <span>ğŸ«–</span>
                    <span>ÙØ±Ù†Ú† Ù¾Ø±Ø³</span>
                </button>
                <button class="method-btn" data-method="aeropress">
                    <span>âš¡</span>
                    <span>Ø§ÛŒØ±ÙˆÙ¾Ø±Ø³</span>
                </button>
            </div>

            <button class="generate-btn" id="generateBtn">
                <span>âœ¨ Ø³Ø§Ø®Øª ØªØ±Ú©ÛŒØ¨ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</span>
                <div class="loading-bar" id="loadingBar"></div>
            </button>
        </div>

        <div class="result-panel" id="resultPanel">
            <div class="card">
                <div class="card-header">
                    <div class="card-header-icon">ğŸ¯</div>
                    <h2>ØªØ±Ú©ÛŒØ¨ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ø´Ù…Ø§</h2>
                </div>

                <div class="roast-badge" id="roastBadge">
                    <span>Ø³Ø·Ø­ Ø¨Ø±Ø´ØªÚ¯ÛŒ:</span>
                    <span class="roast-dot medium" id="roastDot"></span>
                    <span id="roastText">Ù…ØªÙˆØ³Ø·</span>
                </div>

                <div class="blend-list" id="blendList">
                    <!-- Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ±Ú©ÛŒØ¨ Ø¨Ø§ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </div>

                <div class="flavor-chart">
                    <svg class="flavor-svg" viewBox="0 0 200 200">
                        <circle cx="100" cy="100" r="80" fill="none" stroke="#C4A484" stroke-width="1" stroke-dasharray="5,5"/>
                        <circle cx="100" cy="100" r="60" fill="none" stroke="#C4A484" stroke-width="1" stroke-dasharray="5,5"/>
                        <circle cx="100" cy="100" r="40" fill="none" stroke="#C4A484" stroke-width="1" stroke-dasharray="5,5"/>
                        <circle cx="100" cy="100" r="20" fill="none" stroke="#C4A484" stroke-width="1" stroke-dasharray="5,5"/>
                        
                        <polygon id="flavorPolygon" points="100,20 160,100 100,180 40,100" 
                                 fill="rgba(166, 123, 91, 0.3)" 
                                 stroke="#6F4E37" 
                                 stroke-width="3"
                                 stroke-linejoin="round"/>
                        
                        <text x="100" y="15" text-anchor="middle" fill="#2C1810" font-size="12">ØªÙ„Ø®ÛŒ</text>
                        <text x="185" y="105" text-anchor="middle" fill="#2C1810" font-size="12">Ø§Ø³ÛŒØ¯ÛŒØªÛŒ</text>
                        <text x="100" y="190" text-anchor="middle" fill="#2C1810" font-size="12">Ø´ÛŒØ±ÛŒÙ†ÛŒ</text>
                        <text x="15" y="105" text-anchor="middle" fill="#2C1810" font-size="12">Ø¨Ø§Ø¯ÛŒ</text>
                    </svg>
                </div>

                <div class="instructions">
                    <h3>ğŸ“‹ Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ</h3>
                    <ul class="instructions-list" id="instructionsList">
                        <!-- Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø§ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                    </ul>
                </div>
            </div>
        </div>

        <div class="footer">
            Ø¨Ø§ â˜• Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¹Ø§Ø´Ù‚Ø§Ù† Ù‚Ù‡ÙˆÙ‡
        </div>
    </div>

    <script>
        // Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù‚Ù‡ÙˆÙ‡
        const coffeeDB = [
            {
                id: 1,
                name: "Ø§ØªÛŒÙˆÙ¾ÛŒ ÛŒØ±Ú¯Ø§Ú†Ù",
                bitterness: 25,
                acidity: 85,
                sweetness: 70,
                body: 35,
                fruitiness: 90,
                roastLevel: "Light",
                methods: ["pourOver", "aeropress"],
                brewingParams: {
                    espresso: { temp: "Û¹Û²", time: "Û²Û¸", ratio: "Û±:Û².Ûµ", grind: "Ø®ÛŒÙ„ÛŒ Ø±ÛŒØ²" },
                    pourOver: { temp: "Û¹Û°", time: "Û±Û¸Û°", ratio: "Û±:Û±Û¶", grind: "Ù…ØªÙˆØ³Ø· Ø±ÛŒØ²" },
                    frenchPress: { temp: "Û¹Û´", time: "Û²Û´Û°", ratio: "Û±:Û±Ûµ", grind: "Ø¯Ø±Ø´Øª" },
                    aeropress: { temp: "Û¸Ûµ", time: "Û¹Û°", ratio: "Û±:Û±Û°", grind: "Ù…ØªÙˆØ³Ø·" }
                }
            },
            {
                id: 2,
                name: "Ú©Ù„Ù…Ø¨ÛŒØ§ Ø³ÙˆÙ¾Ø±ÛŒÙ…Ùˆ",
                bitterness: 50,
                acidity: 60,
                sweetness: 75,
                body: 70,
                fruitiness: 55,
                roastLevel: "Medium",
                methods: ["espresso", "pourOver", "frenchPress", "aeropress"],
                brewingParams: {
                    espresso: { temp: "Û¹Û³", time: "Û³Û°", ratio: "Û±:Û²", grind: "Ø®ÛŒÙ„ÛŒ Ø±ÛŒØ²" },
                    pourOver: { temp: "Û¹Û²", time: "Û²Û±Û°", ratio: "Û±:Û±Ûµ", grind: "Ù…ØªÙˆØ³Ø· Ø±ÛŒØ²" },
                    frenchPress: { temp: "Û¹Ûµ", time: "Û²Û·Û°", ratio: "Û±:Û±Û´", grind: "Ø¯Ø±Ø´Øª" },
                    aeropress: { temp: "Û¸Û¸", time: "Û±Û²Û°", ratio: "Û±:Û±Û²", grind: "Ù…ØªÙˆØ³Ø·" }
                }
            },
            {
                id: 3,
                name: "Ø¨Ø±Ø²ÛŒÙ„ Ø³Ø§Ù†ØªÙˆØ³",
                bitterness: 75,
                acidity: 25,
                sweetness: 60,
                body: 85,
                fruitiness: 30,
                roastLevel: "Dark",
                methods: ["espresso", "frenchPress"],
                brewingParams: {
                    espresso: { temp: "Û¹Û´", time: "Û²Ûµ", ratio: "Û±:Û±.Ûµ", grind: "Ø®ÛŒÙ„ÛŒ Ø±ÛŒØ²" },
                    pourOver: { temp: "Û¹Û³", time: "Û±Û¸Û°", ratio: "Û±:Û±Û´", grind: "Ù…ØªÙˆØ³Ø·" },
                    frenchPress: { temp: "Û¹Û¶", time: "Û²Û´Û°", ratio: "Û±:Û±Û³", grind: "Ø¯Ø±Ø´Øª" },
                    aeropress: { temp: "Û¹Û°", time: "Û±Û°Û°", ratio: "Û±:Û¸", grind: "Ù…ØªÙˆØ³Ø·" }
                }
            },
            {
                id: 4,
                name: "Ú©Ù†ÛŒØ§ AA",
                bitterness: 55,
                acidity: 90,
                sweetness: 60,
                body: 55,
                fruitiness: 85,
                roastLevel: "Medium-Light",
                methods: ["pourOver", "aeropress"],
                brewingParams: {
                    espresso: { temp: "Û¹Û±", time: "Û²Û·", ratio: "Û±:Û²", grind: "Ø®ÛŒÙ„ÛŒ Ø±ÛŒØ²" },
                    pourOver: { temp: "Û¸Û¹", time: "Û±Û¹Ûµ", ratio: "Û±:Û±Û¶", grind: "Ù…ØªÙˆØ³Ø· Ø±ÛŒØ²" },
                    frenchPress: { temp: "Û¹Û³", time: "Û²ÛµÛµ", ratio: "Û±:Û±Ûµ", grind: "Ø¯Ø±Ø´Øª" },
                    aeropress: { temp: "Û¸Û·", time: "Û±Û±Û°", ratio: "Û±:Û±Û±", grind: "Ù…ØªÙˆØ³Ø·" }
                }
            },
            {
                id: 5,
                name: "Ú¯ÙˆØ§ØªÙ…Ø§Ù„Ø§ Ø¢Ù†ØªÛŒÚ¯ÙˆØ§",
                bitterness: 60,
                acidity: 65,
                sweetness: 70,
                body: 75,
                fruitiness: 50,
                roastLevel: "Medium",
                methods: ["espresso", "pourOver", "frenchPress"],
                brewingParams: {
                    espresso: { temp: "Û¹Û³", time: "Û²Û¸", ratio: "Û±:Û²", grind: "Ø®ÛŒÙ„ÛŒ Ø±ÛŒØ²" },
                    pourOver: { temp: "Û¹Û±", time: "Û²Û°Û°", ratio: "Û±:Û±Ûµ", grind: "Ù…ØªÙˆØ³Ø·" },
                    frenchPress: { temp: "Û¹Û´", time: "Û²Û¶Û°", ratio: "Û±:Û±Û´", grind: "Ø¯Ø±Ø´Øª" },
                    aeropress: { temp: "Û¸Û¹", time: "Û¹Ûµ", ratio: "Û±:Û¹", grind: "Ù…ØªÙˆØ³Ø·" }
                }
            },
            {
                id: 6,
                name: "Ø³ÙˆÙ…Ø§ØªØ±Ø§ Ù…Ø§Ù†Ø¯Ù„ÛŒÙ†Ú¯",
                bitterness: 80,
                acidity: 30,
                sweetness: 50,
                body: 90,
                fruitiness: 35,
                roastLevel: "Medium-Dark",
                methods: ["espresso", "frenchPress"],
                brewingParams: {
                    espresso: { temp: "Û¹Ûµ", time: "Û²Û¶", ratio: "Û±:Û²", grind: "Ø®ÛŒÙ„ÛŒ Ø±ÛŒØ²" },
                    pourOver: { temp: "Û¹Û´", time: "Û±Û¹Û°", ratio: "Û±:Û±Û´", grind: "Ù…ØªÙˆØ³Ø·" },
                    frenchPress: { temp: "Û¹Û¶", time: "Û²ÛµÛ°", ratio: "Û±:Û±Û²", grind: "Ø¯Ø±Ø´Øª" },
                    aeropress: { temp: "Û¹Û±", time: "Û±Û°Ûµ", ratio: "Û±:Û±Û°", grind: "Ù…ØªÙˆØ³Ø·" }
                }
            }
        ];

        // Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ DOM
        const sliders = {
            bitterness: document.getElementById('bitterness'),
            acidity: document.getElementById('acidity'),
            sweetness: document.getElementById('sweetness'),
            body: document.getElementById('body'),
            fruitiness: document.getElementById('fruitiness')
        };

        const sliderValues = {
            bitterness: document.getElementById('bitternessVal'),
            acidity: document.getElementById('acidityVal'),
            sweetness: document.getElementById('sweetnessVal'),
            body: document.getElementById('bodyVal'),
            fruitiness: document.getElementById('fruitinessVal')
        };

        const methodBtns = document.querySelectorAll('.method-btn');
        const generateBtn = document.getElementById('generateBtn');
        const loadingBar = document.getElementById('loadingBar');
        const resultPanel = document.getElementById('resultPanel');
        const blendList = document.getElementById('blendList');
        const instructionsList = document.getElementById('instructionsList');
        const flavorPolygon = document.getElementById('flavorPolygon');
        const roastDot = document.getElementById('roastDot');
        const roastText = document.getElementById('roastText');

        let selectedMethod = 'espresso';

        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø§Ø³Ù„Ø§ÛŒØ¯Ø±Ù‡Ø§
        for (const [key, slider] of Object.entries(sliders)) {
            slider.addEventListener('input', () => {
                sliderValues[key].textContent = slider.value + '%';
            });
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ´ Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ
        methodBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                methodBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedMethod = btn.dataset.method;
            });
        });

        // Ø¨Ø³ØªÙ† Ù¾Ø§Ù¾â€ŒØ¢Ù¾
        window.closePopup = function() {
            document.getElementById('welcomePopup').classList.remove('show');
        };

        // Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
        setTimeout(() => {
            document.getElementById('welcomePopup').classList.add('show');
        }, 500);

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ±Ú©ÛŒØ¨ Ø¨Ù‡ÛŒÙ†Ù‡
        function calculateBlend(prefs) {
            // ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø±ÙˆØ´ Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ
            let candidates = coffeeDB.filter(coffee => 
                coffee.methods.includes(prefs.method)
            );

            if (candidates.length === 0) {
                candidates = [...coffeeDB];
            }

            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ø´Ø¨Ø§Ù‡Øª
            const scored = candidates.map(coffee => {
                let score = 0;
                score += (100 - Math.abs(coffee.bitterness - prefs.bitterness)) * 1.2;
                score += (100 - Math.abs(coffee.acidity - prefs.acidity)) * 1.0;
                score += (100 - Math.abs(coffee.sweetness - prefs.sweetness)) * 1.1;
                score += (100 - Math.abs(coffee.body - prefs.body)) * 1.0;
                score += (100 - Math.abs(coffee.fruitiness - prefs.fruitiness)) * 0.9;
                return { ...coffee, score: Math.max(0, score) };
            });

            // Ø§Ù†ØªØ®Ø§Ø¨ Û³ Ù‚Ù‡ÙˆÙ‡ Ø¨Ø±ØªØ±
            const top3 = scored.sort((a, b) => b.score - a.score).slice(0, 3);
            
            if (top3.length === 0) return null;

            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯Ù‡Ø§
            const totalScore = top3.reduce((sum, c) => sum + c.score, 0);
            
            if (totalScore === 0) {
                top3.forEach(c => c.percentage = Math.floor(100 / top3.length));
            } else {
                let remaining = 100;
                top3.forEach((c, i) => {
                    if (i === top3.length - 1) {
                        c.percentage = remaining;
                    } else {
                        c.percentage = Math.floor((c.score / totalScore) * 100);
                        remaining -= c.percentage;
                    }
                });
            }

            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø·Ø¹Ù… Ù†Ù‡Ø§ÛŒÛŒ
            const flavorProfile = {
                bitterness: 0,
                acidity: 0,
                sweetness: 0,
                body: 0,
                fruitiness: 0
            };

            top3.forEach(coffee => {
                flavorProfile.bitterness += coffee.bitterness * (coffee.percentage / 100);
                flavorProfile.acidity += coffee.acidity * (coffee.percentage / 100);
                flavorProfile.sweetness += coffee.sweetness * (coffee.percentage / 100);
                flavorProfile.body += coffee.body * (coffee.percentage / 100);
                flavorProfile.fruitiness += coffee.fruitiness * (coffee.percentage / 100);
            });

            // ØªØ¹ÛŒÛŒÙ† Ø³Ø·Ø­ Ø¨Ø±Ø´ØªÚ¯ÛŒ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†
            const roastMap = { "Light": 1, "Medium-Light": 2, "Medium": 3, "Medium-Dark": 4, "Dark": 5 };
            const roastValue = top3.reduce((sum, c) => sum + (roastMap[c.roastLevel] * c.percentage), 0) / 100;
            
            let roastLevel;
            if (roastValue <= 1.5) roastLevel = "Light";
            else if (roastValue <= 2.5) roastLevel = "Medium-Light";
            else if (roastValue <= 3.5) roastLevel = "Medium";
            else if (roastValue <= 4.5) roastLevel = "Medium-Dark";
            else roastLevel = "Dark";

            return {
                coffees: top3,
                flavorProfile,
                roastLevel,
                primaryCoffee: top3[0]
            };
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
        function displayResults(blend) {
            if (!blend) return;

            // Ù†Ù…Ø§ÛŒØ´ ØªØ±Ú©ÛŒØ¨
            blendList.innerHTML = blend.coffees.map(coffee => `
                <div class="blend-item">
                    <span class="blend-name">${coffee.name}</span>
                    <span class="blend-percent">${coffee.percentage}%</span>
                </div>
            `).join('');

            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø± Ø·Ø¹Ù…
            const center = 100;
            const radius = 70;
            
            const bY = center - (blend.flavorProfile.bitterness / 100) * radius;
            const aX = center + (blend.flavorProfile.acidity / 100) * radius;
            const sY = center + (blend.flavorProfile.sweetness / 100) * radius;
            const boX = center - (blend.flavorProfile.body / 100) * radius;
            
            flavorPolygon.setAttribute('points', `${center},${bY} ${aX},${center} ${center},${sY} ${boX},${center}`);

            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø±Ø´ØªÚ¯ÛŒ
            const roastClass = blend.roastLevel.toLowerCase().replace('-', '');
            roastDot.className = `roast-dot ${roastClass}`;
            roastText.textContent = blend.roastLevel;

            // Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ
            const params = blend.primaryCoffee.brewingParams[selectedMethod];
            if (params) {
                instructionsList.innerHTML = `
                    <li>Ø¯Ù…Ø§ÛŒ Ø¢Ø¨: ${params.temp}Â°C</li>
                    <li>Ø²Ù…Ø§Ù† Ø¯Ù…â€ŒØ¢ÙˆØ±ÛŒ: ${params.time} Ø«Ø§Ù†ÛŒÙ‡</li>
                    <li>Ù†Ø³Ø¨Øª Ù‚Ù‡ÙˆÙ‡ Ø¨Ù‡ Ø¢Ø¨: ${params.ratio}</li>
                    <li>Ø¯Ø±Ø¬Ù‡ Ø¢Ø³ÛŒØ§Ø¨: ${params.grind}</li>
                `;
            }

            resultPanel.classList.add('show');
        }

        // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© Ø¯Ú©Ù…Ù‡ ØªÙˆÙ„ÛŒØ¯
        generateBtn.addEventListener('click', () => {
            const userPrefs = {
                bitterness: parseInt(sliders.bitterness.value),
                acidity: parseInt(sliders.acidity.value),
                sweetness: parseInt(sliders.sweetness.value),
                body: parseInt(sliders.body.value),
                fruitiness: parseInt(sliders.fruitiness.value),
                method: selectedMethod
            };

            generateBtn.disabled = true;
            loadingBar.style.width = '100%';

            setTimeout(() => {
                const blend = calculateBlend(userPrefs);
                displayResults(blend);
                
                generateBtn.disabled = false;
                loadingBar.style.width = '0%';
            }, 2000);
        });
    </script>
</body>
</html>